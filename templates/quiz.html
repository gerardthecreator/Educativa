<!-- templates/quiz.html -->

{% extends 'layout.html' %}

{% block content %}
<div class="quiz-container">
    <nav class="breadcrumbs">
        <a href="{{ url_for('dashboard') }}">Dashboard</a> &raquo;
        <a href="{{ url_for('view_lesson', subject_slug=subject_name, lesson_slug=lesson.slug) }}">{{ lesson.title }}</a> &raquo;
        <span>Autoevaluación</span>
    </nav>
    
    <div class="quiz-header">
        <h2>{{ quiz.title }}</h2>
        <p>Pon a prueba tus conocimientos sobre la lección. ¡Mucha suerte, panita!</p>
    </div>

    <form method="POST" action="{{ url_for('take_quiz', subject_slug=subject_name, lesson_slug=lesson.slug) }}" class="quiz-form">
        
        {# --- BUCLE SIMPLIFICADO Y CORREGIDO --- #}
        {# Iteramos sobre la nueva variable que nos da el índice (i) y la pregunta (question) #}
        {% for i, question in enumerated_questions %}
        
            <div class="question-block">
                <p class="question-text">
                    {# Usamos i + 1 para mostrar el número de pregunta (1, 2, 3...) #}
                    <strong>Pregunta {{ i + 1 }}:</strong> {{ question.text|safe }}
                </p>
                
                <div class="options-group">
                    {% for option in question.options %}
                    <label class="option-label">
                        {# El 'name' del input usa el índice 'i' que ya tenemos. Es mucho más simple y robusto. #}
                        <input type="radio" name="question-{{ i }}" value="{{ option }}" required>
                        <span>{{ option }}</span>
                    </label>
                    {% endfor %}
                </div>
            </div>
        
        {% endfor %}
        {# --- FIN DEL BUCLE SIMPLIFICADO --- #}
        
        <button type="submit" class="btn btn-primary quiz-submit-btn">Entregar Autoevaluación</button>
    </form>
</div>
{% endblock %}
